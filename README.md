# 超声波检测静态障碍物体项目客户端——最新分支

## 1 动机
+ 电瓶车室内充电可能会造成重大火灾
+ 消防通道被堵塞将导致严重的人身财产损失

## 2 目标
提出利用超声波对这些室内场景进行监管： 
+ 有效检测出目标区域内是否堆积杂物或者停放电动车
+ 若存在堆积的杂物或电动车，则进一步尝试确定其所在的位置
+ 排除行人以及室内其他固有物体、设备的干扰

## 3 整体处理流程
处理流程整体如下： 
+ 步骤 1：**采集环境空旷状态下的参照信号**。确认空旷环境，在此状态下扬声器向目标区域周期性发射频段为 x<sub>0</sub>Hz</sub>~ x<sub>1</sub>Hz 的超声波，记该信号为**U**，与此同时麦克风收集环境中声波信号，将其写入文件保存；记该状态下采集的信号为 P<sub>0</sub> 。 
+ 步骤 2：**采集环境待检测状态下的实际信号**。任意时刻下扬声器向目标区域周期性发射超声波**U** ，同时麦克风收集环境中的声波信号，将其写入文件保存；记该态下采集的信号为 P<sub>1</sub>。 
+ 步骤 3：**带通滤波**。将时域信号 P<sub>0</sub> 和 P<sub>1</sub>进行傅里叶变换转换成频域上的信号，滤出其中频段为 x<sub>0</sub>Hz</sub>~ x<sub>1</sub>Hz 的部分再后转为时域信号，分别记为 P<sub>0</sub><sup>1</sup>和 P<sub>1</sub><sup>1</sup>。 
+ 步骤 4：**互相关操作**。将信号 P<sub>0</sub><sup>1</sup>和 P<sub>1</sub><sup>1</sup>分别与发射的超声波**U**进行互相关，分别得到信号 P<sub>0</sub><sup>2</sup>和 P<sub>1</sub><sup>2</sup> 。 
+ 步骤 5：**多周期叠加并归一化**。将 P<sub>0</sub><sup>2</sup>和 P<sub>1</sub><sup>2</sup> 分别按照直射信号进行切分并叠加各周期数据，之后按照统一的标准进行归一化，得到信号 P<sub>0</sub><sup>3</sup>和 P<sub>1</sub><sup>3</sup> 。 
+ 步骤 6：**包络检波**。对 P<sub>0</sub><sup>3</sup>和 P<sub>1</sub><sup>3</sup> 提取信号的上包络线，记为 P<sub>0</sub><sup>4</sup>和 P<sub>1</sub><sup>4</sup> ，之后比较二者曲线的相似程度以判断环境是否发生变化及确定目标距离等。 
+ 步骤 7：重复执行步骤 2 ~ 步骤 6。 

其中，对于步骤 6 中的判断操作我们做进一步的解释： (v0 ,t0 ),(v1 ,t1 ),...,(vn ,tn ) = Compare(P<sub>0</sub><sup>4</sup>和 P<sub>1</sub><sup>4</sup>)  
  Compare为曲线比较算法，得到的结果中元素(vi ,ti)表示 ti 时刻下二者采集到的信号有 差异，差异值为vi 。之后对所有的差异值进行判断即可确定环境是否发生变化；在通过上述过程有效检测到环境发生变化的前提下，比较所有的vi ，找出最明显差异处所对应的时刻 tm，代入反射式测距公式可得到目标物体距离。
  
## 4 客户端实现
客户端主要由三个模块组成，它们分别是声波发射模块（包括扬声器和线性功放器），声波接收模块（麦克风循环阵列套件）以及控制与计算模块（树莓派系统及算法）。
